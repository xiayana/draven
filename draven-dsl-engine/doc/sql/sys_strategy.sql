/*
Navicat MySQL Data Transfer

Source Server         : 101.42.242.227
Source Server Version : 50633
Source Host           : 101.42.242.227:3306
Source Database       : draven_db

Target Server Type    : MYSQL
Target Server Version : 50633
File Encoding         : 65001

Date: 2022-04-01 11:27:45
*/

SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for sys_strategy
-- ----------------------------
DROP TABLE IF EXISTS `sys_strategy`;
CREATE TABLE `sys_strategy` (
                                `id` bigint(20) NOT NULL AUTO_INCREMENT,
                                `policy_id` varchar(255) COLLATE utf8_bin DEFAULT NULL COMMENT '策略名称',
                                `allowed` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `cmd` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `dst` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `host` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `src` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `timestamp` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `user` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `esper_sql` text COLLATE utf8_bin,
                                `update_time` datetime DEFAULT NULL,
                                `create_time` datetime DEFAULT NULL,
                                `status` int(11) NOT NULL DEFAULT '1' COMMENT '0失效1生效',
                                `description` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                `slide_win_enabled` tinyint(1) unsigned DEFAULT '0' COMMENT '滑动窗口 0失效  1生效',
                                `win_time` varchar(255) COLLATE utf8_bin DEFAULT NULL COMMENT '滑动窗口-time',
                                `win_group` varchar(255) COLLATE utf8_bin DEFAULT NULL COMMENT '滑动窗口-分组',
                                `win_condition` varchar(255) COLLATE utf8_bin DEFAULT NULL COMMENT '滑动窗口-条件',
                                `time_reweight` int(11) DEFAULT '0' COMMENT '去重时间间隔',
                                `aggregation_conditions` varchar(255) COLLATE utf8_bin DEFAULT NULL,
                                PRIMARY KEY (`id`),
                                UNIQUE KEY `policy_id` (`policy_id`) USING BTREE
) ENGINE=InnoDB AUTO_INCREMENT=64 DEFAULT CHARSET=utf8 COLLATE=utf8_bin;

-- ----------------------------
-- Records of sys_strategy
-- ----------------------------
INSERT INTO `sys_strategy` VALUES ('1', '测试', 'allowed in(1,2,3)', 'cmd=4', '1', '1', '1', '8', '1', 0x73656C65637420636D642C616C6C6F7765642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C277465737431272061732070696C6963795F6964202C2735272061732074696D655F7265776569676874202066726F6D206D6F62696C6C6F63616C74696F6E20776865726520636D6420696E20282731272C2732272C2733272920, '2022-02-07 19:01:24', '2022-01-31 19:01:26', '0', null, null, null, null, null, '0', null);
INSERT INTO `sys_strategy` VALUES ('2', '测试2', '1', '6', '1', '1', '1', '8', '1', 0x73656C65637420636D642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C277465737432272061732070696C6963795F6964202C2735272061732074696D655F7265776569676874202066726F6D206D6F62696C6C6F63616C74696F6E20776865726520636D64206C696B65202725312527, '2022-02-04 21:43:37', '2022-02-04 21:43:39', '0', null, null, null, null, null, '0', null);
INSERT INTO `sys_strategy` VALUES ('3', '测试3', '1', '4', '1', '1', '1', '8', '1', 0x73656C65637420636D642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C277465737433272061732070696C6963795F69642C2735272061732074696D655F7265776569676874202066726F6D206D6F62696C6C6F63616C74696F6E20776865726520636D64203D20273627, '2022-02-04 21:43:58', '2022-02-04 21:44:03', '1', null, null, null, null, null, '0', null);
INSERT INTO `sys_strategy` VALUES ('4', '测试4', '1', '1', '1', '1', '1', '8', '1', 0x73656C65637420636D642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C277465737432272061732070696C6963795F6964202C2735272061732074696D655F72657765696768742066726F6D206D6F62696C6C6F63616C74696F6E2E77696E3A74696D655F6261746368283520736563292067726F757020627920636D6420686176696E6720636F756E7428636D64293C3320206F72646572206279206473742064657363, '2022-02-04 21:46:28', '2022-02-04 21:46:31', '1', null, null, null, null, null, '0', null);
INSERT INTO `sys_strategy` VALUES ('10', '让他忽然121231', null, 'cmd in (\'5\',\'6\',\'7\')', 'dst = \'test\'', null, null, '4', 'user = \'bababa\'', 0x73656C65637420636D642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C27E8AEA9E4BB96E5BFBDE784B6313231323331272061732070696C6963795F69642066726F6D206D6F62696C6C6F63616C74696F6E202077686572652031203D20312020616E6420636D6420696E20282735272C2736272C2737272920616E642075736572203D20276261626162612720616E6420647374203D20277465737427, '2022-02-10 16:54:08', '2022-02-10 16:54:08', '0', null, null, null, null, null, '0', null);
INSERT INTO `sys_strategy` VALUES ('61', 'a', '[{\"condition\": \"==\", \"value\": \"none\"}]', '[{\"condition\": \"==\", \"value\": \"cmd1\"}, {\"condition\": \"!=\", \"value\": \"cmd2\"}, {\"condition\": \"contains\", \"value\": \"cmdd\"}, {\"condition\": \"regexp\", \"value\": \"cmd_re\"}]', '[{\"condition\": \"==\", \"value\": \"dst1\"}, {\"condition\": \"!=\", \"value\": \"dst2\"}, {\"condition\": \"contains\", \"value\": \"dst3\"}, {\"condition\": \"regexp\", \"value\": \"dst4\"}]', '[{\"condition\": \"==\", \"value\": \"2.2.2.2\"}, {\"condition\": \"!=\", \"value\": \"2.2.2.3\"}, {\"condition\": \"contains\", \"value\": \"vv\"}, {\"condition\": \"regexp\", \"value\": \"regexp\"}]', '[{\"condition\": \"==\", \"value\": \"src1\"}, {\"condition\": \"!=\", \"value\": \"src2\"}, {\"condition\": \"contains\", \"value\": \"src3\"}, {\"condition\": \"regexp\", \"value\": \"src4\"}]', '[{\"condition\": \"==\", \"value\": \"11\"}, {\"condition\": \"!=\", \"value\": \"22\"}, {\"condition\": \">\", \"value\": \"33\"}, {\"condition\": \"<=\", \"value\": \"44\"}]', '[{\"condition\": \"==\", \"value\": \"u1\"}, {\"condition\": \"!=\", \"value\": \"user2\"}, {\"condition\": \"contains\", \"value\": \"uuss\"}, {\"condition\": \"regexp\", \"value\": \"rabc\"}]', 0x73656C65637420636D642C616C6C6F7765642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C202761272061732070696C6963795F69642C202730272061732074696D655F7265776569676874202C6D61782874696D657374616D70292066726F6D206D6F62696C6C6F63616C74696F6E2E77696E3A74696D655F6261746368283130206D696E29202077686572652031203D20312020616E64202820686F7374203D2027322E322E322E322720206F7220686F737420213D2027322E322E322E332720206F7220686F7374206C696B652027257676252720206F7220686F73742072656765787020277265676578702720202920616E64202820616C6C6F776564203D20276E6F6E652720202920616E6420282075736572203D202775312720206F72207573657220213D202775736572322720206F722075736572206C696B6520272575757373252720206F722075736572207265676578702027726162632720202920616E64202820636D64203D2027636D64312720206F7220636D6420213D2027636D64322720206F7220636D64206C696B65202725636D6464252720206F7220636D64207265676578702027636D645F72652720202920616E64202820647374203D2027647374312720206F722064737420213D2027647374322720206F7220647374206C696B6520272564737433252720206F7220647374207265676578702027647374342720202920616E64202820737263203D2027737263312720206F722073726320213D2027737263322720206F7220737263206C696B6520272573726333252720206F7220737263207265676578702027737263342720202920616E6420282074696D657374616D70203D20313120206F722074696D657374616D7020213D20323220206F722074696D657374616D70203E20333320206F722074696D657374616D70203C3D2034342020292067726F757020627920636D64202C74696D657374616D7020686176696E6720636F756E742874696D657374616D7029203E3D2034, '2022-03-18 16:58:52', '2022-03-18 16:58:52', '1', null, '1', '10 min', 'cmd', '{\"condition\": \">=\", \"value\": \"4\"}', '0', null);
INSERT INTO `sys_strategy` VALUES ('62', 'a1', '[{\"condition\": \"==\", \"value\": \"none\"}]', '[{\"condition\": \"==\", \"value\": \"cmd1\"}, {\"condition\": \"!=\", \"value\": \"cmd2\"}, {\"condition\": \"contains\", \"value\": \"cmdd\"}, {\"condition\": \"regexp\", \"value\": \"cmd_re\"}]', '[{\"condition\": \"==\", \"value\": \"dst1\"}, {\"condition\": \"!=\", \"value\": \"dst2\"}, {\"condition\": \"contains\", \"value\": \"dst3\"}, {\"condition\": \"regexp\", \"value\": \"dst4\"}]', '[{\"condition\": \"==\", \"value\": \"2.2.2.2\"}, {\"condition\": \"!=\", \"value\": \"2.2.2.3\"}, {\"condition\": \"contains\", \"value\": \"vv\"}, {\"condition\": \"regexp\", \"value\": \"regexp\"}]', '[{\"condition\": \"==\", \"value\": \"src1\"}, {\"condition\": \"!=\", \"value\": \"src2\"}, {\"condition\": \"contains\", \"value\": \"src3\"}, {\"condition\": \"regexp\", \"value\": \"src4\"}]', '[{\"condition\": \"==\", \"value\": \"11\"}, {\"condition\": \"!=\", \"value\": \"22\"}, {\"condition\": \">\", \"value\": \"33\"}, {\"condition\": \"<=\", \"value\": \"44\"}]', '[{\"condition\": \"==\", \"value\": \"u1\"}, {\"condition\": \"!=\", \"value\": \"user2\"}, {\"condition\": \"contains\", \"value\": \"uuss\"}, {\"condition\": \"regexp\", \"value\": \"rabc\"}]', 0x73656C65637420636D642C616C6C6F7765642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C20276131272061732070696C6963795F69642C202730272061732074696D655F7265776569676874202C6D61782874696D657374616D70292066726F6D206D6F62696C6C6F63616C74696F6E2E77696E3A74696D655F6261746368283130206D696E29202077686572652031203D20312020616E64202820686F7374203D2027322E322E322E322720206F7220686F737420213D2027322E322E322E332720206F7220686F7374206C696B652027257676252720206F7220686F73742072656765787020277265676578702720202920616E64202820616C6C6F776564203D20276E6F6E652720202920616E6420282075736572203D202775312720206F72207573657220213D202775736572322720206F722075736572206C696B6520272575757373252720206F722075736572207265676578702027726162632720202920616E64202820636D64203D2027636D64312720206F7220636D6420213D2027636D64322720206F7220636D64206C696B65202725636D6464252720206F7220636D64207265676578702027636D645F72652720202920616E64202820647374203D2027647374312720206F722064737420213D2027647374322720206F7220647374206C696B6520272564737433252720206F7220647374207265676578702027647374342720202920616E64202820737263203D2027737263312720206F722073726320213D2027737263322720206F7220737263206C696B6520272573726333252720206F7220737263207265676578702027737263342720202920616E6420282074696D657374616D70203D20313120206F722074696D657374616D7020213D20323220206F722074696D657374616D70203E20333320206F722074696D657374616D70203C3D2034342020292067726F757020627920636D64202C74696D657374616D7020686176696E6720636F756E742874696D657374616D7029203E3D2034, '2022-03-18 16:59:04', '2022-03-18 16:59:04', '1', null, '1', '10 min', 'cmd', '{\"condition\": \">=\", \"value\": \"4\"}', '0', null);
INSERT INTO `sys_strategy` VALUES ('63', 'a12', '[{\"condition\": \"==\", \"value\": \"none\"}]', '[{\"condition\": \"==\", \"value\": \"cmd1\"}, {\"condition\": \"!=\", \"value\": \"cmd2\"}, {\"condition\": \"contains\", \"value\": \"cmdd\"}, {\"condition\": \"regexp\", \"value\": \"cmd_re\"}]', '[{\"condition\": \"==\", \"value\": \"dst1\"}, {\"condition\": \"!=\", \"value\": \"dst2\"}, {\"condition\": \"contains\", \"value\": \"dst3\"}, {\"condition\": \"regexp\", \"value\": \"dst4\"}]', '[{\"condition\": \"==\", \"value\": \"2.2.2.2\"}, {\"condition\": \"!=\", \"value\": \"2.2.2.3\"}, {\"condition\": \"contains\", \"value\": \"vv\"}, {\"condition\": \"regexp\", \"value\": \"regexp\"}]', '[{\"condition\": \"==\", \"value\": \"src1\"}, {\"condition\": \"!=\", \"value\": \"src2\"}, {\"condition\": \"contains\", \"value\": \"src3\"}, {\"condition\": \"regexp\", \"value\": \"src4\"}]', '[{\"condition\": \"==\", \"value\": \"11\"}, {\"condition\": \"!=\", \"value\": \"22\"}, {\"condition\": \">\", \"value\": \"33\"}, {\"condition\": \"<=\", \"value\": \"44\"}]', '[{\"condition\": \"==\", \"value\": \"u1\"}, {\"condition\": \"!=\", \"value\": \"user2\"}, {\"condition\": \"contains\", \"value\": \"uuss\"}, {\"condition\": \"regexp\", \"value\": \"rabc\"}]', 0x73656C65637420636D642C616C6C6F7765642C6473742C757365722C7372632C7069642C707069642C74696D657374616D702C69702C2027613132272061732070696C6963795F69642C202730272061732074696D655F7265776569676874202C6D61782874696D657374616D70292066726F6D206D6F62696C6C6F63616C74696F6E2E77696E3A74696D655F6261746368283130206D696E29202077686572652031203D20312020616E64202820686F7374203D2027322E322E322E322720206F7220686F737420213D2027322E322E322E332720206F7220686F7374206C696B652027257676252720206F7220686F73742072656765787020277265676578702720202920616E64202820616C6C6F776564203D20276E6F6E652720202920616E6420282075736572203D202775312720206F72207573657220213D202775736572322720206F722075736572206C696B6520272575757373252720206F722075736572207265676578702027726162632720202920616E64202820636D64203D2027636D64312720206F7220636D6420213D2027636D64322720206F7220636D64206C696B65202725636D6464252720206F7220636D64207265676578702027636D645F72652720202920616E64202820647374203D2027647374312720206F722064737420213D2027647374322720206F7220647374206C696B6520272564737433252720206F7220647374207265676578702027647374342720202920616E64202820737263203D2027737263312720206F722073726320213D2027737263322720206F7220737263206C696B6520272573726333252720206F7220737263207265676578702027737263342720202920616E6420282074696D657374616D70203D20313120206F722074696D657374616D7020213D20323220206F722074696D657374616D70203E20333320206F722074696D657374616D70203C3D2034342020292067726F757020627920636D64202C74696D657374616D7020686176696E6720636F756E742874696D657374616D7029203E3D2034, '2022-03-18 16:59:11', '2022-03-18 16:59:11', '1', null, '1', '10 min', 'cmd', '{\"condition\": \">=\", \"value\": \"4\"}', '0', null);
